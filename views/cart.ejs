<%-include('header')%>

    <!-- Offcanvas Overlay -->
    <div class="offcanvas-overlay"></div>

    <!-- ...:::: Start Breadcrumb Section:::... -->
    <div class="breadcrumb-section breadcrumb-bg-color--golden">
        <div class="breadcrumb-wrapper">
            <div class="container">
                <div class="row">
                    <div class="col-12">
                        <h3 class="breadcrumb-title">Cart</h3>
                        <div class="breadcrumb-nav breadcrumb-nav-color--black breadcrumb-nav-hover-color--golden">
                            <nav aria-label="breadcrumb">
                                <ul>
                                    <li><a href="/home">Home</a></li>
                                    <li><a href="/shop">Shop</a></li>
                                    <li class="active" aria-current="page">Cart</li>
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div> <!-- ...:::: End Breadcrumb Section:::... -->

    <!-- ...:::: Start Cart Section:::... -->
    <div class="cart-section">
        <!-- Start Cart Table -->
        <div class="cart-table-wrapper" data-aos="fade-up" data-aos-delay="0">
            <div class="container">
                <div class="row">
                    <div class="col-12">
                        <div class="table_desc">
                            <div class="table_page table-responsive">
                                <table class=".table-cart">
                                  
                                    <thead>
                                        <tr>
                                            <th class="product_remove">Delete</th>
                                            <th class="product_thumb">Image</th>
                                            <th class="product_name">Product</th>
                                            <th class="product-price">Price</th>
                                            <th class="product_quantity">Quantity</th>
                                            <th class="product_total">Total</th>
                                        </tr>
                                    </thead> 
                                     <tbody>
                                       
                                        <%if (cart && cart.items.length>0){
                                            for(let i=0;i<cart.items.length;i++){%>
                                        <tr>
                                            <td class="product_remove"><button type="button" onclick="confirmdelete('<%= cart.items[i].productId._id%>')"><i class="fa fa-trash-o"></i></button>
                                            </td>
                                            <%if(cart.items[i].productId.countInStock===0){ %>
                                                <td class="product_thumb"><a href="/productdetails?id=<%=cart.items[i].productId._id %>"><img
                                                        src="userImages/<%=cart.items[i].productId.images[0]%>"
                                                        alt=""></a>
                                                        <p class="badge badge-danger">Out of Stock</p>
                                                        </td>
                                            <%}else{%>
                                            <td class="product_thumb"><a href="/productdetails?id=<%=cart.items[i].productId._id %>"><img
                                                        src="userImages/<%=cart.items[i].productId.images[0]%>"
                                                        alt=""></a></td>
                                                        <%}%>
                                            <td class="product_name"><a href="/productdetails?id=<%=cart.items[i].productId._id %>"><%=cart.items[i].productId.productname%></a></td>
                                            <td class="product-price">Rs.<%=cart.items[i].productId.price %>.00</td>
                                                <td>
                                            <div class="detail-qty  radius  m-auto">
                                            <button class="qty-down " id="qty-down<%=cart.items[i].productId._id %>" onclick="updateQuantity( '<%=cart.items[i].productId._id %>','<%= cart.items[i].productId.countinstock %>','<%=cart.items[i].quantity %>','sub')"><i class="fa-solid fa-angle-down"></i>
                                                    </button>
                                                    
                                            <span class="qty-val me-3" id="qty-<%= cart.items[i].productId._id%>"><%= cart.items[i].quantity %></span>
                                                   
                                            <button class="qty-up" id="qty-up<%=cart.items[i].productId._id %>"  onclick="updateQuantity('<%=cart.items[i].productId._id %>','<%= cart.items[i].productId.countinstock %>','<%=cart.items[i].quantity %>','sum')"><i class="fa-solid fa-angle-up"></i>
                                                    </i></button>
                                        </div>
                                            </td>
                                            <td class="product_total"><span id="carttotal-<%= cart.items[i].productId._id%>"> Rs.<%=cart.items[i].price%>.00</span></td>
                                        </tr>
                                        <%}}%>
                                            
                                    </tbody>
                                      
                                </table>
                            </div>
                           
                        </div>
                    </div>
                </div>
            </div>
        </div> <!-- End Cart Table -->

        <!-- Start Coupon Start -->
        <div class="coupon_area">
            <div class="container">
                <div class="row">
                    <div class="col-lg-6 col-md-6">
                        <% if (cart.couponapplied === false) { %>
                            <div class="coupon_code left" data-aos="fade-up" data-aos-delay="200">
                                <h3>Coupon</h3>
                                <form action="/checkcoupon" method="post">
                                    <div class="coupon_inner">
                                        <p>Enter your coupon code if you have one.</p>
                                        <input class="mb-2" name="couponcode" placeholder="Coupon code" type="text">
                                        <button type="submit" class="btn btn-md btn-golden">Apply coupon</button>
                                        <!-- Button to trigger modal -->
                                        <button type="button" class="btn btn-md btn-golden" data-toggle="modal" data-target="#couponModal">Show Coupons</button>
                                    </div>
                                </form>
                            </div>
                        <% } else { %>
                            <div class="coupon_code left" data-aos="fade-up" data-aos-delay="200">
                                <h3>Coupon</h3>
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th scope="col">Coupon Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Coupon  applied.</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <% } %>
                    </div>
                    <div class="col-lg-6 col-md-6">
                        <div class="coupon_code right" data-aos="fade-up" data-aos-delay="400">
                            <h3>Cart Totals</h3>

                            <div class="coupon_inner">
                                <% if (cart.couponapplied === true) { %>
                                    <div class="cart_subtotal">
                                        <p>Total</p>
                                        <p class="cart_amount" id="carttotal2">Rs.<%= cart.billTotal %>.00</p>
                                    </div>
                                  
                                    <div class="cart_subtotal">
                                        <p>Discount price</p>
                                        <p class="cart_amount" id="discount">Rs.<%= cart.discountPrice %>.00</p>
                                    </div>
                                    <div class="cart_subtotal">
                                        <p>Shipping</p>
                                        <% if (cart.shipping > 0) { %>
                                            <p class="cart_amount1" id="shipping">Rs.<%= cart.shipping %>.00</p>
                                        <% } else { %>
                                            <p class="cart_amount">Free Shipping</p>
                                        <% } %>
                                    </div>
                                    <div class="cart_subtotal">
                                        <p>Subtotal</p>
                                        <p class="cart_amount" id="carttotal2">Rs.<%= cart.billTotal %>.00</p>
                                    </div>
                                    <button onclick="removecoupon('<%= cart._id %>')" class="btn btn-md btn-golden">Remove coupon</button>
                                <% } else { %>
                                    <div class="cart_subtotal">
                                        <p>Shipping</p>
                                        <% if (cart.shipping > 0) { %>
                                            <p class="cart_amount1" id="shipping">Rs.<%= cart.shipping %>.00</p>
                                        <% } else { %>
                                            <p class="cart_amount">Free Shipping</p>
                                        <% } %>
                                    </div>

                                    <div class="cart_subtotal">
                                        <p>Subtotal</p>
                                        <p class="cart_amount" id="carttotal2">Rs.<%= cart.billTotal %>.00</p>
                                    </div>
                                   
                                   
                                
                                <% } %>
                            
                                <% let allInStock = cart.items.every(item => item.productId.countinstock > 0); %>
                                <% if (allInStock) { %>
                                    <div class="checkout_btn">
                                     
                                        <button><a href="/checkout" class="btn btn-md btn-golden">Proceed to Checkout</a></button>
                                    </div>
                                <% } %>
                            </div>
                            

                        


                    </div>
                  
                </div>
            </div>
        </div> <!-- End Coupon Start -->
    </div> <!-- ...:::: End Cart Section:::... -->
  


    <div class="modal fade" id="couponModal" tabindex="-1" role="dialog" aria-labelledby="couponModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="couponModalLabel">Available Coupons</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <ul>
                        <% if (coupon && coupon.length > 0) { %>
                            <% for (let i = 0; i < coupon.length; i++) { %>
                                <% if (cart.billTotal > coupon[i].minimumAmount && cart.billTotal < coupon[i].maximumAmount) { %>
                                    <% if (coupon[i].usersUsed.includes(user)) { %>
                                        <div class="card">
                                            <div class="card-body">
                                                <h5 class="card-title">Coupon Details</h5>
                                                <p class="card-text">Coupon code: <%= coupon[i].code %></p>
                                                <p class="card-text">Discount: <%= coupon[i].discountPercentage %> %</p>
                                                <p class="card-text">Expiration Date: <%= new Date(coupon[i].expirationDate).toLocaleDateString() %></p>
                                                <h6 style="color: #cb2d2d;">Coupon already applied</h6>
                                            </div>
                                        </div>
                                    <% } else { %>
                                        <div class="card">
                                            <div class="card-body">
                                                <h5 class="card-title">Coupon Details</h5>
                                                <p class="card-text">Coupon code: <%= coupon[i].code %></p>
                                                <p class="card-text">Discount: <%= coupon[i].discountPercentage %> %</p>
                                                <p class="card-text">Expiration Date: <%= new Date(coupon[i].expirationDate).toLocaleDateString() %></p>
                                                <button type="button" class="btn btn-outline-secondary" onclick="populateCoupon('<%= coupon[i].code %>')">
                                                    <%= coupon[i].code %>
                                                </button>
                                            </div>
                                        </div>
                                    <% } %>
                                <% } %>
                            <% } %>
                        <% } else { %>
                            <p>No coupons available</p>
                        <% } %>
                        
                    </ul>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    



    <!-- Start Footer Section -->
    <footer class="footer-section footer-bg section-top-gap-100">
        <div class="footer-wrapper">
            <!-- Start Footer Top -->
            <div class="footer-top">
                <div class="container">
                    <div class="row mb-n6">
                        <div class="col-lg-3 col-sm-6 mb-6">
                            <!-- Start Footer Single Item -->
                            <div class="footer-widget-single-item footer-widget-color--golden" data-aos="fade-up"
                                data-aos-delay="0">
                                <h5 class="title">INFORMATION</h5>
                                <ul class="footer-nav">
                                    <li><a href="#">Delivery Information</a></li>
                                    <li><a href="#">Terms & Conditions</a></li>
                                    <li><a href="contact-us.html">Contact</a></li>
                                    <li><a href="#">Returns</a></li>
                                </ul>
                            </div>
                            <!-- End Footer Single Item -->
                        </div>
                        <div class="col-lg-3 col-sm-6 mb-6">
                            <!-- Start Footer Single Item -->
                            <div class="footer-widget-single-item footer-widget-color--golden" data-aos="fade-up"
                                data-aos-delay="200">
                                <h5 class="title">MY ACCOUNT</h5>
                                <ul class="footer-nav">
                                    <li><a href="#">My account</a></li>
                                    <li><a href="#">Wishlist</a></li>
                                    <li><a href="#">Privacy Policy</a></li>
                                    <li><a href="#">Frequently Questions</a></li>
                                    <li><a href="#">Order History</a></li>
                                </ul>
                            </div>
                            <!-- End Footer Single Item -->
                        </div>
                        <div class="col-lg-3 col-sm-6 mb-6">
                            <!-- Start Footer Single Item -->
                            <div class="footer-widget-single-item footer-widget-color--golden" data-aos="fade-up"
                                data-aos-delay="400">
                                <h5 class="title">CATEGORIES</h5>
                                <ul class="footer-nav">
                                    <li><a href="#">HAIR</a></li>
                                    <li><a href="#">BODY</a></li>
                                    <li><a href="#">FACE</a></li>
                                    
                                </ul>
                            </div>
                            <!-- End Footer Single Item -->
                        </div>
                        <div class="col-lg-3 col-sm-6 mb-6">
                            <!-- Start Footer Single Item -->
                            <div class="footer-widget-single-item footer-widget-color--golden" data-aos="fade-up"
                                data-aos-delay="600">
                                <h5 class="title">ABOUT US</h5>
                                <div class="footer-about">
                                    <p>We are a team of designers and developers that create high quality Magento,
                                        Prestashop, Opencart.</p>

                                    <address class="address">
                                        <span>Address: Your address goes here.</span>
                                        <span>Email: everglow@gmail.com</span>
                                    </address>
                                </div>
                            </div>
                            <!-- End Footer Single Item -->
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Footer Top -->

            <!-- Start Footer Center -->
            <div class="footer-center">
                <div class="container">
                    <div class="row mb-n6">
                        <div class="col-xl-3 col-lg-4 col-md-6 mb-6">
                            <div class="footer-social" data-aos="fade-up" data-aos-delay="0">
                                <h4 class="title">FOLLOW US</h4>
                                <ul class="footer-social-link">
                                    <li><a href="#"><i class="fa fa-facebook"></i></a></li>
                                    <li><a href="#"><i class="fa fa-twitter"></i></a></li>
                                    <li><a href="#"><i class="fa fa-instagram"></i></a></li>
                                    <li><a href="#"><i class="fa fa-linkedin"></i></a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-xl-7 col-lg-6 col-md-6 mb-6">
                            <div class="footer-newsletter" data-aos="fade-up" data-aos-delay="200">
                                <h4 class="title">DON'T MISS OUT ON THE LATEST</h4>
                                <div class="form-newsletter">
                                    <form action="#" method="post">
                                        <div class="form-fild-newsletter-single-item input-color--golden">
                                            <input type="email" placeholder="Your email address..." required>
                                            <button type="submit">SUBSCRIBE!</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Start Footer Center -->

            <!-- Start Footer Bottom -->
            <div class="footer-bottom">
                <div class="container">
                    <div
                        class="row justify-content-between align-items-center align-items-center flex-column flex-md-row mb-n6">
                        <div class="col-auto mb-6">
                            <div class="footer-copyright">
                                <p class="copyright-text">&copy; 2024 <a href="index.html">EverGlow</a>. Made with <i
                                        class="fa fa-heart text-danger"></i> by <a href="#"
                                        target="_blank">EverGlow</a> </p>

                            </div>
                        </div>
                        <div class="col-auto mb-6">
                            <div class="footer-payment">
                                <div class="image">
                                    <img src="assets/images/company-logo/payment.png" alt="">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Start Footer Bottom -->
        </div>
    </footer>
    <!-- End Footer Section -->

    <!-- material-scrolltop button -->
    <button class="material-scrolltop" type="button"></button>

    <!-- Start Modal Add cart -->
    <div class="modal fade" id="modalAddcart" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog  modal-dialog-centered modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-body">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col text-right">
                                <button type="button" class="close modal-close" data-bs-dismiss="modal"
                                    aria-label="Close">
                                    <span aria-hidden="true"> <i class="fa fa-times"></i></span>
                                </button>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-7">
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="modal-add-cart-product-img">
                                            <img class="img-fluid"
                                                src="assets/images/product/default/home-1/default-1.jpg" alt="">
                                        </div>
                                    </div>
                                    <div class="col-md-8">
                                        <div class="modal-add-cart-info"><i class="fa fa-check-square"></i>Added to cart
                                            successfully!</div>
                                        <div class="modal-add-cart-product-cart-buttons">
                                            <a href="cart.html">View Cart</a>
                                            <a href="checkout.html">Checkout</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-5 modal-border">
                                <ul class="modal-add-cart-product-shipping-info">
                                    <li> <strong><i class="icon-shopping-cart"></i> There Are 5 Items In Your
                                            Cart.</strong></li>
                                    <li> <strong>TOTAL PRICE: </strong> <span>$187.00</span></li>
                                    <li class="modal-continue-button"><a href="#" data-bs-dismiss="modal">CONTINUE
                                            SHOPPING</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div> <!-- End Modal Add cart -->

    <!-- Start Modal Quickview cart -->
    <div class="modal fade" id="modalQuickview" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog  modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-body">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col text-right">
                                <button type="button" class="close modal-close" data-bs-dismiss="modal"
                                    aria-label="Close">
                                    <span aria-hidden="true"> <i class="fa fa-times"></i></span>
                                </button>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="product-details-gallery-area mb-7">
                                    <!-- Start Large Image -->
                                    <div class="product-large-image modal-product-image-large swiper-container">
                                        <div class="swiper-wrapper">
                                            <div class="product-image-large-image swiper-slide img-responsive">
                                                <img src="assets/images/product/default/home-1/default-1.jpg" alt="">
                                            </div>
                                            <div class="product-image-large-image swiper-slide img-responsive">
                                                <img src="assets/images/product/default/home-1/default-2.jpg" alt="">
                                            </div>
                                            <div class="product-image-large-image swiper-slide img-responsive">
                                                <img src="assets/images/product/default/home-1/default-3.jpg" alt="">
                                            </div>
                                            <div class="product-image-large-image swiper-slide img-responsive">
                                                <img src="assets/images/product/default/home-1/default-4.jpg" alt="">
                                            </div>
                                            <div class="product-image-large-image swiper-slide img-responsive">
                                                <img src="assets/images/product/default/home-1/default-5.jpg" alt="">
                                            </div>
                                            <div class="product-image-large-image swiper-slide img-responsive">
                                                <img src="assets/images/product/default/home-1/default-6.jpg" alt="">
                                            </div>
                                        </div>
                                    </div>
                                    <!-- End Large Image -->
                                    <!-- Start Thumbnail Image -->
                                    <div
                                        class="product-image-thumb modal-product-image-thumb swiper-container pos-relative mt-5">
                                        <div class="swiper-wrapper">
                                            <div class="product-image-thumb-single swiper-slide">
                                                <img class="img-fluid"
                                                    src="assets/images/product/default/home-1/default-1.jpg" alt="">
                                            </div>
                                            <div class="product-image-thumb-single swiper-slide">
                                                <img class="img-fluid"
                                                    src="assets/images/product/default/home-1/default-2.jpg" alt="">
                                            </div>
                                            <div class="product-image-thumb-single swiper-slide">
                                                <img class="img-fluid"
                                                    src="assets/images/product/default/home-1/default-3.jpg" alt="">
                                            </div>
                                            <div class="product-image-thumb-single swiper-slide">
                                                <img class="img-fluid"
                                                    src="assets/images/product/default/home-1/default-4.jpg" alt="">
                                            </div>
                                            <div class="product-image-thumb-single swiper-slide">
                                                <img class="img-fluid"
                                                    src="assets/images/product/default/home-1/default-5.jpg" alt="">
                                            </div>
                                            <div class="product-image-thumb-single swiper-slide">
                                                <img class="img-fluid"
                                                    src="assets/images/product/default/home-1/default-6.jpg" alt="">
                                            </div>
                                        </div>
                                        <!-- Add Arrows -->
                                        <div class="gallery-thumb-arrow swiper-button-next"></div>
                                        <div class="gallery-thumb-arrow swiper-button-prev"></div>
                                    </div>
                                    <!-- End Thumbnail Image -->
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="modal-product-details-content-area">
                                    <!-- Start  Product Details Text Area-->
                                    <div class="product-details-text">
                                        <h4 class="title">Nonstick Dishwasher PFOA</h4>
                                        <div class="price"><del>$70.00</del>$80.00</div>
                                    </div> <!-- End  Product Details Text Area-->
                                    <!-- Start Product Variable Area -->
                                    <div class="product-details-variable">
                                        <!-- Product Variable Single Item -->
                                        <div class="variable-single-item">
                                            <span>Color</span>
                                            <div class="product-variable-color">
                                                <label for="modal-product-color-red">
                                                    <input name="modal-product-color" id="modal-product-color-red"
                                                        class="color-select" type="radio" checked>
                                                    <span class="product-color-red"></span>
                                                </label>
                                                <label for="modal-product-color-tomato">
                                                    <input name="modal-product-color" id="modal-product-color-tomato"
                                                        class="color-select" type="radio">
                                                    <span class="product-color-tomato"></span>
                                                </label>
                                                <label for="modal-product-color-green">
                                                    <input name="modal-product-color" id="modal-product-color-green"
                                                        class="color-select" type="radio">
                                                    <span class="product-color-green"></span>
                                                </label>
                                                <label for="modal-product-color-light-green">
                                                    <input name="modal-product-color"
                                                        id="modal-product-color-light-green" class="color-select"
                                                        type="radio">
                                                    <span class="product-color-light-green"></span>
                                                </label>
                                                <label for="modal-product-color-blue">
                                                    <input name="modal-product-color" id="modal-product-color-blue"
                                                        class="color-select" type="radio">
                                                    <span class="product-color-blue"></span>
                                                </label>
                                                <label for="modal-product-color-light-blue">
                                                    <input name="modal-product-color"
                                                        id="modal-product-color-light-blue" class="color-select"
                                                        type="radio">
                                                    <span class="product-color-light-blue"></span>
                                                </label>
                                            </div>
                                        </div>
                                        <!-- Product Variable Single Item -->
                                        <div class="d-flex align-items-center flex-wrap">
                                            <div class="variable-single-item ">
                                                <span>Quantity</span>
                                                <div class="product-variable-quantity">
                                                    <input min="1" max="100" value="1" type="number">
                                                </div>
                                            </div>

                                            <div class="product-add-to-cart-btn">
                                                <a href="#" data-bs-toggle="modal" data-bs-target="#modalAddcart">Add To
                                                    Cart</a>
                                            </div>
                                        </div>
                                    </div> <!-- End Product Variable Area -->
                                    <div class="modal-product-about-text">
                                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Mollitia iste
                                            laborum ad impedit pariatur esse optio tempora sint ullam autem deleniti nam
                                            in quos qui nemo ipsum numquam, reiciendis maiores quidem aperiam, rerum vel
                                            recusandae</p>
                                    </div>
                                    <!-- Start  Product Details Social Area-->
                                    <div class="modal-product-details-social">
                                        <span class="title">SHARE THIS PRODUCT</span>
                                        <ul>
                                            <li><a href="#" class="facebook"><i class="fa fa-facebook"></i></a></li>
                                            <li><a href="#" class="twitter"><i class="fa fa-twitter"></i></a></li>
                                            <li><a href="#" class="pinterest"><i class="fa fa-pinterest"></i></a></li>
                                            <li><a href="#" class="google-plus"><i class="fa fa-google-plus"></i></a>
                                            </li>
                                            <li><a href="#" class="linkedin"><i class="fa fa-linkedin"></i></a></li>
                                        </ul>

                                    </div> <!-- End  Product Details Social Area-->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div> <!-- End Modal Quickview cart -->

    <!-- ::::::::::::::All JS Files here :::::::::::::: -->
    <!-- Global Vendor, plugins JS -->
    <!-- <script src="assets/js/vendor/modernizr-3.11.2.min.js"></script>
    <script src="assets/js/vendor/jquery-3.5.1.min.js"></script>
    <script src="assets/js/vendor/jquery-migrate-3.3.0.min.js"></script>
    <script src="assets/js/vendor/popper.min.js"></script>
    <script src="assets/js/vendor/bootstrap.min.js"></script>
    <script src="assets/js/vendor/jquery-ui.min.js"></script>  -->

    <!--Plugins JS-->
    <!-- <script src="assets/js/plugins/swiper-bundle.min.js"></script>
    <script src="assets/js/plugins/material-scrolltop.js"></script>
    <script src="assets/js/plugins/jquery.nice-select.min.js"></script>
    <script src="assets/js/plugins/jquery.zoom.min.js"></script>
    <script src="assets/js/plugins/venobox.min.js"></script>
    <script src="assets/js/plugins/jquery.waypoints.js"></script>
    <script src="assets/js/plugins/jquery.lineProgressbar.js"></script>
    <script src="assets/js/plugins/aos.min.js"></script>
    <script src="assets/js/plugins/jquery.instagramFeed.js"></script>
    <script src="assets/js/plugins/ajax-mail.js"></script> -->

    <!-- Use the minified version files listed below for better performance and remove the files listed above -->
    <script src="assets/js/vendor/vendor.min.js"></script>
    <script src="assets/js/plugins/plugins.min.js"></script>

    <!-- Main JS -->
    <script src="assets/js/main.js"></script> 
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>ed

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    
    
       <script>
     async function updateQuantity(productId, stock, qty, need) {
    const verify = (need === 'sub') ? (parseInt(qty) > 1) : ((need === 'sum') ? (parseInt(qty) < parseInt(stock)) : false);

    if (verify) {
        try {
            const res = await fetch('/updateQuantity', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    productId,
                    need,
                    qty
                })
            });

            const data = await res.json();
            if (data.success) {
                for (let i = 0; i < data.cart.items.length; i++) {
                    document.getElementById(`qty-${data.cart.items[i].productId._id}`).innerHTML = data.cart.items[i].quantity;
                    document.getElementById(`carttotal-${data.cart.items[i].productId._id}`).innerHTML = `Rs.${data.cart.items[i].price}.00`;
                    setupClickListeners(data.cart.items[i].productId._id, data.cart.items[i].productId.countInStock);
                }
                document.getElementById('carttotal2').innerHTML = `Rs.${data.cart.billTotal}.00`;
                document.getElementById('carttotal3').innerHTML = `Rs.${data.cart.billTotal}.00`;
                document.getElementById('shipping').innerHTML = `Rs.${data.cart.shipping}.00`;
            } else {
                await Swal.fire({
                    title: 'Error',
                    text: res.status === 404 ? 'Stock limit exceeded.' : 'Maximum quantity per person for this product has been reached',
                    icon: 'error',
                    showConfirmButton: true
                });
            }
        } catch (error) {
            console.log(error.message);
        }
    } else {
        await Swal.fire({
            title: 'Error',
            text: 'Stock limit exceeded.',
            icon: 'error',
            showConfirmButton: true
        });
    }
}

function setupClickListeners(productId, stock) {
    const qtyDownElement = document.getElementById(`qty-down${productId}`);
    const qtyUpElement = document.getElementById(`qty-up${productId}`);

    if (qtyDownElement && qtyUpElement) {
        const currentQty = parseInt(document.getElementById(`qty-${productId}`).innerHTML);
        qtyDownElement.disabled = currentQty <= 1;
        qtyUpElement.disabled = currentQty >= stock;

        qtyDownElement.removeEventListener('click', handleQtyDownClick);
        qtyUpElement.removeEventListener('click', handleQtyUpClick);

        qtyDownElement.addEventListener('click', handleQtyDownClick);
        qtyUpElement.addEventListener('click', handleQtyUpClick);
    } else {
        console.error(`Elements for product ${productId} not found.`);
    }
}

function handleQtyDownClick() {
    const productId = this.id.replace('qty-down', '');
    const stock = parseInt(document.getElementById(`qty-${productId}`).getAttribute('data-stock'));
    const currentQty = parseInt(document.getElementById(`qty-${productId}`).innerHTML);
    if (currentQty > 1) {
        updateQuantity(productId, stock, currentQty, 'sub');
    }
}

function handleQtyUpClick() {
    const productId = this.id.replace('qty-up', '');
    const stock = parseInt(document.getElementById(`qty-${productId}`).getAttribute('data-stock'));
    const currentQty = parseInt(document.getElementById(`qty-${productId}`).innerHTML);
    if (currentQty < stock) {
        updateQuantity(productId, stock, currentQty, 'sum');
    }
}



   </script> 




    
    
    
    
    
    <script>
        function goTocheckout(){
            $.ajax({
  url: '/api/data', 
  type: 'GET', 
  dataType: 'json',
  success: function(response) { 
    console.log('Data received:', response); 
    
  },
  error: function(xhr, status, error) { 
    console.error('Error:', error);
 
  }
});

        }
    
    
</script>
<script>
    function confirmdelete(id){
    Swal.fire({
        title: "Confirmation",
        text: "Are you sure you want to delete this product?",
        icon: "warning",
        showCancelButton: true,
        confirmButtonColor: "#3085d6",
        cancelButtonColor: "#d33",
        confirmButtonText: "Yes, delete it"
    }).then((result) => {
        if (result.isConfirmed) {
            $.ajax({
                url: "/deletecartitem",
                method: "GET",
                data: { id: id },
                success: function(response) {
                 window.location.reload()
                },
                error: function(xhr, status, error) {
                    // Handle errors
                    console.error(error);
                    Swal.fire({
                        icon: 'error',
                        title: 'Oops...',
                        text: 'Something went wrong!',
                    });
                }
            });
        }
    });
}

</script>
<script>
function applyCoupon() {
    var couponCode = document.querySelector('input[name="couponcode"]').value;
    
    fetch('/checkcoupon', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({ couponcode: couponCode }),
    })
    .then(response => {
        if (!response.ok) {
            throw new Error('Network response was not ok');
        }
        return response.json();
    })
    .then(data => {
        console.log('Coupon applied successfully:', data);
        setTimeout(function() {
            window.location.reload();
        }, 2000);
    })
    .catch(error => {
        console.error('Error applying coupon:', error);
    });
}
function populateCoupon(code) {
    document.querySelector('input[name="couponcode"]').value = code;
    // Optionally, close the modal after populating the coupon code
    $('#couponModal').modal('hide');
}

function removecoupon(id) {
    $.ajax({
        url: "/removecoupon?id=" + id,
        method: "POST",
        success: function(response) {
            // Handle success
            console.log("Coupon removed successfully");
            // Optionally, you can reload the page
            window.location.reload();
        },
        error: function(xhr, status, error) {
            // Handle errors
            console.error(error);
            alert("Something went wrong!");
        }
    });
}
</script>

</body>


</html>